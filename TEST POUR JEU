import java.io.BufferedReader;
import java.io.BufferedWriter;
import java.io.IOException;
import java.io.InputStreamReader;
import java.io.OutputStreamWriter;
import java.io.PrintWriter;
import java.net.ServerSocket;
import java.net.Socket;
import java.net.UnknownHostException;
import java.util.ArrayList;
import java.util.List;
import java.util.Scanner;


public class ServeurMT extends Thread {
	String hostName = "127.0.0.1";
	int nbJoueurs; 
	private boolean fin;
	private String gagnant;
	
	
	public void run() {
		try {
			ServerSocket ss = new ServerSocket(2345);
			System.out.println("Serveur ecoute");
			while(true) {
				Socket s=ss.accept();
				++nbJoueurs;
				new Conversation(s,nbJoueurs).start();
			}
		}catch (IOException e) {
			e.printStackTrace();
		}
	}//a chaque joueur en plus, le num du joueur connecté augmente 
	
	class Conversation extends Thread{
		private Socket socket;
		private int numeroJoueur;
		
		public Conversation (Socket socket, int num) {
			super();
			this.socket = socket; 
			this.numeroJoueur=num;
		} 
		
		public void run() {
			//code de la conv
			try {
				BufferedReader plec = new BufferedReader(new InputStreamReader(socket.getInputStream()));
				
				PrintWriter pred = new PrintWriter(new BufferedWriter(new OutputStreamWriter(socket.getOutputStream())),true);
				
				
				String IP = socket.getRemoteSocketAddress().toString();
				
				System.out.println("Connexion du client numéro "+numeroJoueur+" IP= "+IP);
				pred.println("Bienvenue, vous êtes le client numéro "+numeroJoueur+". Donner un mot:");
				
			} catch (Exception e) {
				e.printStackTrace();
			}
		}
	}
	public static void main (String[] args) {
		new ServeurMT().start();
	}

}

import java.io.BufferedReader;
import java.io.BufferedWriter;
import java.io.InputStreamReader;
import java.io.OutputStreamWriter;
import java.io.PrintWriter;
import java.net.Socket;
import java.util.Scanner;

public class Joueur1 {
static final int port = 2345 ;
	
	public static void main(String[] args) throws Exception{
		Socket socket1 = new Socket ("127.0.0.1", port);
		System.out.println("SOCKET+" + socket1);
		System.out.println("entrer 1 pour jouer");
		
		BufferedReader plec = new BufferedReader( new InputStreamReader(socket1.getInputStream()));
		
		PrintWriter pred = new PrintWriter(new BufferedWriter(new OutputStreamWriter(socket1.getOutputStream())),
				true);
		
	    
		Scanner scan = new Scanner (System.in);
		for (int i =0; i<10; i++) {
			String s=scan.nextLine();
			pred.println(s);
			String str = plec.readLine();
			System.out.println("Joueur1 recoit:" +str);
		
		}
		
		System.out.println("Fin Joueur1");
		pred.println("END");
		plec.close();
		pred.close();
		socket1.close();
	}
}
